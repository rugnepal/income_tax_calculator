year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
taxable_inc <- income - cit
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
}
1000000/3
income_tax(1000000, 2078, 300000) %>% sum()
income_tax(790000, 2078, 300000) %>% sum()
790000/3
income_tax(790000, 2078, 263333.3) %>% sum()
income_tax(790000, 2078, 263333.3)
income_tax(790000, 2078, 263333.3) %>% sum()
960000 /3
income_tax(960000, 2078, 300000) %>% sum()
income_tax(960000, 2078, 300000)
income_tax(960000, 2079, 300000)
income_tax(960000, 2079, 300000) %>% sum()
income_tax(960000, 2078, 300000) %>% sum()
income_tax(960000, 2078, 500000) %>% sum()
income_tax(960000, 2079, 500000) %>% sum()
960000 - 500000
460000 / 12
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
taxable_inc <- income - cit
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
}
income_tax(960000, 2079, 500000) %>% sum()
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income = cit,
"N" = cit
)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
}
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income = cit,
"N" = cit
)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
}
taxable_inc <- switch(as.character(cit),
"Y" = income = cit,
"N" = cit
)
taxable_inc <- switch(as.character(cit),
"Y" = income = cit,
"N" = cit)
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income - cit,
"N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
}
income_tax(960000, 2079, T)
income_tax(960000, 2079, Y)
income_tax(960000, 2079, "Y")
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
#
# taxable_inc <- switch(as.character(cit),
#        "Y" = income - cit,
#        "N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
cit
}
income_tax(960000, 2079, "Y")
options(scipen = 999)
income_tax(960000, 2079, "Y")
income_tax(960000, 2079, Y)
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
#
# taxable_inc <- switch(as.character(cit),
#        "Y" = income - cit,
#        "N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
cit
}
income_tax(960000, 2079, Y)
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income - cit,
"N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, Y)
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income - cit,
"N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, Y)
options(scipen = 999)
library(tidyverse)
single_2079_80 <- c(".01" = 500000, ".10" = 700000, ".20" = 800000, ".30" = 1500000, ".36" = Inf)
single_2078_79 <- c(".01" = 400000, ".10" = 500000, ".20" = 700000, ".30" = 2000000, ".36" = Inf)
rate <- \(x) names(x) |> as.numeric()
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income - cit,
"N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, Y)
options(scipen = 999)
single_2079_80 <- c(".01" = 500000, ".10" = 700000, ".20" = 800000, ".30" = 1500000, ".36" = Inf)
single_2078_79 <- c(".01" = 400000, ".10" = 500000, ".20" = 700000, ".30" = 2000000, ".36" = Inf)
rate <- \(x) names(x) |> as.numeric()
income_tax <- \(income,
year,
cit) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
cit <- ifelse(income / 3 > 300000, 300000, income / 3)
taxable_inc <- switch(as.character(cit),
"Y" = income - cit,
"N" = cit)
#
# brackets <- unname(slab)
# rates <- rate(slab)
#
# cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
# cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, Y)
income_tax <- \(income,
year,
cit,
ssf,
life,
medical
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
taxable_inc <- income - cit - ssf - life - medical
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, Y)
income_tax(960000, 2079, 30000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
taxable_inc <- income - cit - ssf - life - medical
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, 30000)
income_tax(960000, 2079, 30000) %>% sum()
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
cal[which(cal != 0)]
data.frame(brackets, rates, cal)
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(brackets, rates, cal)
table[which(table != 0)]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(brackets, rates, cal)
table[which(cal != 0)]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(brackets, rates, cal)
table[which(table$cal != 0)]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(brackets, rates, cal)
table[which(table$cal != 0), ]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(brackets, rates*100, cal)
table[which(table$cal != 0), ]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(taxable_income = brackets, rate= rates*100, tax_liability = cal)
table[which(table$cal != 0), ]
# cit
}
income_tax(960000, 2079, 300000)
income_tax <- \(income=0,
year=0,
cit=0,
ssf=0,
life=0,
medical=0
) {
slab <- switch(as.character(year),
"2078" = single_2078_79,
"2079" = single_2079_80
)
deducible <- cit - ssf - life - medical
taxable_inc <- income - deducible
# cit <- ifelse(income / 3 > 300000, 300000, income / 3)
# taxable_inc <- switch(as.character(cit),
# "Y" = income - cit,
# "N" = cit)
brackets <- unname(slab)
rates <- rate(slab)
cal <- diff(c(0, pmin(taxable_inc, brackets))) * rates
table <- data.frame(taxable_income = brackets, rate= rates*100, tax_liability = cal)
table[which(table$tax_liability != 0), ]
# cit
}
income_tax(960000, 2079, 300000)
styler:::style_selection()
shiny::runApp('shiny')
